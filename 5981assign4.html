<!DOCTYPE html>
<html>
<head>
<title>Race Game</title>

<style>
body {
    background-image:url('images/face.jpeg');
    font-family: Arial, sans-serif;
    text-align: center;
}

/* Track box */
#track {
    width: 700px;
    height: 400px;
    border: 3px solid black;
    position: relative;
    left:250px;
    padding-top: 20px;
}

/* Start line */
.start-line {
    width: 5px;
    height: 280px;
    background: blue;
    position: absolute;
    left: 10px;
    top: 30px;
}

/* Finish line */
.finish-line {
    width: 8px;
    height: 280px;
    background: red;
    position: absolute;
    right: 10px;
    top: 30px;
}

/* Lanes */
.lane {
    width: 100%;
    height: 80px;
    position: relative;
}

/* Runners */
.runner {
    width: 110px;
    height: 70px;
    position: absolute;
    top: 45px;
    left: 15px;
    border-radius: 8px;
    border: 2px solid black;
}

.msg {
    font-size: 22px;
    margin-top: 15px;
    font-weight: bold;
}

.winner { color: green; }
.loser { color: red; }

button {
    background-color:#ffffff;
    border-radius:5px;
    padding: 10px 20px;
    font-size: 18px;
    margin-left:5px;
}

#buttons {
    margin-left:255px;
    position:absolute;
    top:315px;
}
</style>
</head>

<body>

<!-- AUDIO FILES -->
<audio id="winSound" src="audio/myvoic.ogg"></audio>
<audio id="loseSound" src="audio/my.ogg"></audio>

<div id="track">
    <div class="start-line"></div>
    <div class="finish-line"></div>

    <!-- Lane 1 -->
    <div class="lane">
        <img id="runner1" class="runner" src="images/face1.jpeg">
    </div>

    <!-- Lane 2 -->
    <div class="lane">
        <img id="runner2" class="runner" src="images/face1.jpeg">
    </div>
</div>

<br>

<div id="buttons">
    <button id="btnRun">Run</button>
    <button id="btnReset">Reset</button>
    <p id="message" class="msg"></p>
</div>

<script>
const runner1 = document.getElementById("runner1");
const runner2 = document.getElementById("runner2");
const btnRun = document.getElementById("btnRun");
const btnReset = document.getElementById("btnReset");
const msg = document.getElementById("message");
const track = document.getElementById("track");

const winSound = document.getElementById("winSound");
const loseSound = document.getElementById("loseSound");

const RUNNER_SIZE = 110;

function resetRun() {
    runner1.style.transition = "none";
    runner2.style.transition = "none";
    runner1.style.left = "15px";
    runner2.style.left = "15px";
    msg.textContent = "";
    msg.className = "msg";

    winSound.pause(); winSound.currentTime = 0;
    loseSound.pause(); loseSound.currentTime = 0;

    if (window.speechSynthesis) speechSynthesis.cancel();
}

function getFinishX() {
    return track.clientWidth - RUNNER_SIZE - 25;
}

function runRace() {
    resetRun();

    const finishX = getFinishX();

    // Random times
    const t1 = 1500 + Math.random() * 2500;
    const t2 = 1500 + Math.random() * 2500;

    requestAnimationFrame(() => {
        runner1.style.transition = `left ${t1}ms linear`;
        runner2.style.transition = `left ${t2}ms linear`;

        runner1.style.left = finishX + "px";
        runner2.style.left = finishX + "px";
    });

    const winnerIsRunner1 = t1 < t2;
    const resultTime = Math.max(t1, t2) + 50;

    setTimeout(() => {
        if (winnerIsRunner1) {
            msg.textContent = "I am the Winner!";
            msg.className = "msg winner";
            winSound.play();   // play winner audio
        } else {
            msg.textContent = "I am the Loser!";
            msg.className = "msg loser";
            loseSound.play();  // play loser audio
        }
    }, resultTime);
}

btnRun.onclick = runRace;
btnReset.onclick = resetRun;

resetRun();
</script>

</body>
</html>
